# INPUT RAILS

define subflow protect prompt
  """Check if the prompt is valid according to Prompt Security."""
  $invalid = execute protect_text(source="input", text=$user_message)

  if $invalid
    bot inform answer unknown
    stop


# OUTPUT RAILS

define subflow protect response
  """Check if the response is valid according to Prompt Security."""
  $invalid = execute protect_text(source="output", text=$bot_message)

  if $invalid
    bot inform answer unknown
    stop
